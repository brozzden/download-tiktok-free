optStrings={selectors:{feedLoading:"div.tiktok-loading.feed-loading",modalArrowLeft:"div.video-card-modal > div > img.arrow-right",modalClose:".video-card-modal > div > div.close",modalPlayer:"div > div > main > div.video-card-modal > div > div.video-card-big > div.video-card-container > div > div > video",modalShareInput:".copy-link-container > input",modalCaption:"div.video-card-big > div.content-container > div.video-meta-info > h1",modalSoundLink:"div.content-container > div.video-meta-info > h2.music-info > a",modalUploader:".user-username",videoPlayer:"div.video-card-container > div > div > video",videoShareInput:"div.content-container.border > div.copy-link-container > input",videoCaption:"div.content-container.border > div.video-meta-info > h1",videoSoundLink:"div.content-container.border > div.video-meta-info > h2.music-info > a",videoUploader:".user-username"},classes:{feedVideoItem:"video-feed-item-wrapper",modalCloseDisabled:"disabled",titleMessage:"title"},tags:{resultTag:"video_urls",resultParentTag:"body"},attributes:{src:"src"},tiktokMessages:["Couldn't find this account","No videos yet","Video currently unavailable"]},currentState={preloadCount:0,finished:!1},checkForErrors=function(){var e=document.getElementsByClassName(optStrings.classes.titleMessage);if(e&&e.length){var t=Array.from(e).find(e=>optStrings.tiktokMessages.includes(e.textContent)).textContent;if(t)return createVidUrlElement("ERR: "+t),!0}return!1},createVidUrlElement=function(e){var t=document.createElement(optStrings.tags.resultTag);t.innerText=JSON.stringify(e),document.getElementsByTagName(optStrings.tags.resultParentTag)[0].appendChild(t),currentState.finished=!0},buldVidUrlArray=function(e){document.getElementsByClassName(optStrings.classes.feedVideoItem)[0].click();var t=[],o=window.setInterval(r=>{t.push(getCurrentModalVideo());var i=document.querySelectorAll(optStrings.selectors.modalArrowLeft)[0];i.classList.contains(optStrings.classes.modalCloseDisabled)?(window.clearInterval(o),document.querySelector(optStrings.selectors.modalClose).click(),e(t)):i.click()},20)},getCurrentModalVideo=function(){var e=document.querySelector(optStrings.selectors.modalPlayer).getAttribute(optStrings.attributes.src),t=document.querySelector(optStrings.selectors.modalShareInput).value,o=document.querySelector(optStrings.selectors.modalCaption).textContent,r=document.querySelector(optStrings.selectors.modalSoundLink),i=document.querySelector(optStrings.selectors.modalUploader).textContent,n=r.getAttribute("href");return{url:e,shareLink:t,caption:o,uploader:i,sound:{title:r.text,link:n}}},getCurrentVideo=function(){if(!checkForErrors()){var e=document.querySelector(optStrings.selectors.videoPlayer).getAttribute(optStrings.attributes.src),t=document.querySelector(optStrings.selectors.videoShareInput).value,o=document.querySelector(optStrings.selectors.videoCaption).textContent,r=document.querySelector(optStrings.selectors.videoSoundLink),i=document.querySelector(optStrings.selectors.videoUploader).textContent,n=r.getAttribute("href");return{url:e,shareLink:t,caption:o,uploader:i,sound:{title:r.text,link:n}}}},scrollWhileNew=function(e){var t={count:0},o=window.setInterval(r=>{var i=t.count;if(t.count=document.getElementsByClassName(optStrings.classes.feedVideoItem).length,checkForErrors())window.clearInterval(o);else if(i!==t.count)currentState.preloadCount=t.count,window.scrollTo(0,document.body.scrollHeight);else{if(document.querySelector(optStrings.selectors.feedLoading))return void window.scrollTo(0,document.body.scrollHeight);window.clearInterval(o),e(createVidUrlElement)}},1e3)},bootstrapIteratingVideos=function(){return scrollWhileNew(buldVidUrlArray),"bootstrapIteratingVideos"},bootstrapGetCurrentVideo=function(){var e=getCurrentVideo();return createVidUrlElement(e),"bootstrapGetCurrentVideo"},init=()=>{const e=navigator.__proto__;return delete e.webdriver,navigator.__proto__=e,"script initialized"},init();
